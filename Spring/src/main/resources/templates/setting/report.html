<!doctype html>

<html xmlns:th="http://www.thymleaf.org">
<head>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <script type="text/javascript" src="/js/santaUtils.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.9.4/lottie.min.js"></script>
    <link rel="stylesheet" href="/css/style.css" type="text/css">
    <link rel="stylesheet" href="/css/font.css" type="text/css">
    <link rel="stylesheet" href="/css/css.css" type="text/css">
</head>
<style>

    body {
        background-color: #FFEBEE
    }

    .card {
        width: 400px;
        background-color: #fff;
        border: none;
        border-radius: 12px
    }

    label.radio {
        cursor: pointer;
        width: 100%
    }

    label.radio input {
        position: absolute;
        top: 0;
        left: 0;
        visibility: hidden;
        pointer-events: none
    }

    label.radio span {
        padding: 7px 14px;
        border: 2px solid #eee;
        display: inline-block;
        color: #373a3b;
        border-radius: 10px;
        width: 100%;
        height: 48px;
        line-height: 27px
    }

    label.radio input:checked + span {
        border-color: #22d8ac;
        color: #8A8A8A;
        border-radius: 9px;
        height: 48px;
        line-height: 27px
    }

    .form-control {
        margin-top: 10px;
        border: 2px solid #eee;
        border-radius: 10px
    }

    .form-control:focus {
        box-shadow: none;
        border: 2px solid #039BE5
    }

    .agree-text {
        font-size: 12px
    }

</style>

<body style="background-color: white">
<!-- 로딩바 -->
<div class="wrapper" style="display: none;">
    <div id="myGIF"></div>
</div>
<!-- 로딩바 -->
<header class="header">
    <a href="https://santa-community.co.kr/main">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_2_882)">
                <path d="M17.1699 24C17.0383 24.0007 16.9078 23.9755 16.786 23.9257C16.6641 23.876 16.5533 23.8027 16.4599 23.71L8.28988 15.54C7.82425 15.0755 7.45482 14.5238 7.20276 13.9163C6.95069 13.3089 6.82095 12.6577 6.82095 12C6.82095 11.3423 6.95069 10.6911 7.20276 10.0837C7.45482 9.4762 7.82425 8.92445 8.28988 8.45999L16.4599 0.290002C16.5531 0.196764 16.6638 0.122803 16.7856 0.0723425C16.9075 0.0218822 17.038 -0.00408935 17.1699 -0.00408936C17.3017 -0.00408936 17.4323 0.0218822 17.5541 0.0723425C17.676 0.122803 17.7866 0.196764 17.8799 0.290002C17.9731 0.38324 18.0471 0.49393 18.0975 0.615752C18.148 0.737574 18.174 0.868142 18.174 1C18.174 1.13186 18.148 1.26243 18.0975 1.38425C18.0471 1.50607 17.9731 1.61676 17.8799 1.71L9.70988 9.87999C9.14808 10.4425 8.83252 11.205 8.83252 12C8.83252 12.795 9.14808 13.5575 9.70988 14.12L17.8799 22.29C17.9736 22.3829 18.048 22.4935 18.0988 22.6154C18.1495 22.7373 18.1757 22.868 18.1757 23C18.1757 23.132 18.1495 23.2627 18.0988 23.3846C18.048 23.5064 17.9736 23.617 17.8799 23.71C17.7864 23.8027 17.6756 23.876 17.5538 23.9257C17.432 23.9755 17.3015 24.0007 17.1699 24Z"
                      fill="#374957"/>
            </g>
            <defs>
                <clipPath id="clip0_2_882">
                    <rect width="24" height="24" fill="white"/>
                </clipPath>
            </defs>
        </svg>
    </a>
    <h2 style="font-weight: bold; margin-top:1px;">버그리포트</h2>
</header>


<div style="font-size: .8rem;
      border-radius: 10rem;">
    <div class="container mb-5 d-flex justify-content-center">
        <div class="card px-1 py-4">
            <div class="card-body">
                <h6 class="card-title mb-3" id="req_title"></h6>
                <div class="d-flex flex-row" style="padding-bottom: 7%;">
                    <label class="radio mr-1">
                        <input type="radio" name="add" class="radio_mt" value="report" checked>
                        <span style="font-size: 14px; font-weight: bold; text-align: center;"><i class="fa fa-user"></i> 오류보고 </span>
                    </label>

                    <label class="radio">
                        <input type="radio" name="add" class="radio_mt" value="lists">
                        <span style="font-size: 14px; font-weight: bold; text-align: center;"><i class="fa fa-plus-circle"></i> 오류보고 현황 </span>
                    </label>
                </div>

                <form class="bug_report_request">
                    <div id="error_report">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group" style="padding-bottom: 10px">
                                    <label style="font-size: 13px;" for="error_page">오류발생 화면</label>
                                    <input class="form-control" id="error_page" type="text" name="errorpage" placeholder="오류가 발생하는 화면을 입력해주세요" maxlength="30">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label style="font-size: 13px;" for="error_detail">오류 설명</label>
                                    <div class="input-group">
                                    <textarea class="form-control" rows="5" name="errordetail" id="error_detail"
                                              placeholder="오류 설명을 상세하게 적어주세요." maxlength="500"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" name="requestType" value="1">
                </form>

                <div th:each="result : ${result}" class="main_box error_result" style="padding:15px 20px 5px; border-bottom: 1px solid #F4F4F6; display: none;">
                    <div class="box_txt">
                        <p style="padding-left: 10px; font-size: 14px;" th:text="|등록번호 ${result.bugReportNum}|"></p>
                    </div>
                    <p class="">화면명 : <span class="resultDistance" th:text="${result.errorPage}"></span></p>
                    <p class="" style="text-align: right; padding-bottom: 5px; color:#17C99E "><span th:text="${result.errorResult}" style="font-weight: bold"></span></p>
                </div>

                <div class="bug_report_request">
                    <div class=" d-flex flex-column text-center px-5 mt-3 mb-3">
                        <small class="agree-text" style="font-size: 14px;"><span style="font-weight: bold">MY->설정->업데이트</span>에서 <br>처리결과를 확인하실 수 있습니다</small>
                    </div>
                    <div class="button-wrapper">
                        <button class="button" id="nextserve">등록</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>
</body>

<script th:inline="javascript">
    $(function(){
        const result = location.search.substring(5,6);

        if (result == "Y") {
          santaLikeAnimationStart("/json/check.json", 2.5);
          Print.postMessage('성공적으로 접수되었습니다');
        }
    });

    $(".radio_mt").on("click", function () {
       let radio_value = $(this).val();
       if(radio_value == "report"){
         $(".error_result").hide();
         $(".bug_report_request").show();
       }else{
         $(".bug_report_request").hide();
         $(".error_result").show();
       }
    });

    $("#nextserve").on("click",function (){
        let errorPage = $("#error_page").val();
        let errorDetail = $("#error_detail").val();

        if(errorPage && errorDetail){
          $.ajax({
            type: "POST",
            url: "https://santa-community.co.kr/bug/report/request",
            data : {
              "page" : errorPage,
              "detail" : errorDetail
            },
            success : function(res){
              if(res == 1){
                location.replace("/bug/report?res=Y");
              }else{
                console.log("접수실패");
              }
            },
            error : function(XMLHttpRequest, textStatus, errorThrown){
              console.log("접수실패");
            }
          });
        }else{
          Print.postMessage('오류화면과 오류설명을 적어주세요');
        }
    });

</script>
</html>
